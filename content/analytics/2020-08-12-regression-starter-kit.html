---
title: Regression Starter Kit
author: Jeff Cavanagh
date: '2020-08-12'
slug: regression-starter-kit
categories:
  - R
tags: []
lastmod: '2020-08-13T05:25:19-04:00'
layout: post
type: post
highlight: yes
---



<p><strong>This post will cover some of the primary methods of regression analysis available in R. It will also serve as a warmup for the posts that explore Machine Learning and its applications.</strong></p>
<div id="setup" class="section level3">
<h3>Setup</h3>
<p>For our regression data we will look at statistics concerning the history of my favorite sports team, The Detroit Lions. The data comes from <a href="https://www.pro-football-reference.com/teams/det/" target="&quot;_blank">Pro Football Reference</a>.</p>
<pre class="r"><code>lions &lt;- read.csv(&quot;sportsref_download - sportsref_download.csv&quot;)

str(lions)</code></pre>
<pre><code>## &#39;data.frame&#39;:    90 obs. of  29 variables:
##  $ Year       : int  2019 2018 2017 2016 2015 2014 2013 2012 2011 2010 ...
##  $ Lg         : Factor w/ 1 level &quot;NFL&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Tm         : Factor w/ 3 levels &quot;Detroit Lions&quot;,..: 1 1 1 2 1 2 1 1 2 1 ...
##  $ W          : int  3 6 9 9 7 11 7 4 10 6 ...
##  $ L          : int  12 10 7 7 9 5 9 12 6 10 ...
##  $ T          : int  1 0 0 0 0 0 0 0 0 0 ...
##  $ Div..Finish: Factor w/ 19 levels &quot;1st of 4&quot;,&quot;1st of 5&quot;,..: 12 12 5 5 9 5 9 12 5 9 ...
##  $ Playoffs   : Factor w/ 6 levels &quot;&quot;,&quot;Lost Champ&quot;,..: 1 1 1 5 1 5 1 1 5 1 ...
##  $ PF         : int  341 324 410 346 358 321 395 372 474 362 ...
##  $ PA         : int  423 360 376 358 400 282 376 437 387 369 ...
##  $ PD         : int  -82 -36 34 -12 -42 39 19 -65 87 -7 ...
##  $ Coaches    : Factor w/ 27 levels &quot;Caldwell&quot;,&quot;Clark&quot;,..: 20 20 1 1 1 1 26 26 26 26 ...
##  $ AV         : Factor w/ 35 levels &quot;&quot;,&quot;Allen&quot;,&quot;Backus&quot;,..: 16 31 31 31 31 34 34 20 31 34 ...
##  $ Passer     : Factor w/ 40 levels &quot;&quot;,&quot;Batch&quot;,&quot;Clark&quot;,..: 37 37 37 37 37 37 37 37 37 11 ...
##  $ Rusher     : Factor w/ 41 levels &quot;&quot;,&quot;Abdullah&quot;,..: 18 18 2 28 2 3 6 21 4 4 ...
##  $ Receiver   : Factor w/ 47 levels &quot;&quot;,&quot;Barr&quot;,&quot;Box&quot;,..: 16 16 25 42 24 42 24 24 24 24 ...
##  $ Pts        : int  18 25 7 20 18 22 13 17 4 15 ...
##  $ Yds        : int  17 24 13 21 20 19 6 3 5 17 ...
##  $ Pts.1      : int  26 16 21 13 23 3 15 27 23 19 ...
##  $ Yds.1      : int  31 10 27 18 18 2 16 13 23 21 ...
##  $ T.G        : int  24 23 5 20 22 6 28 30 4 11 ...
##  $ Pts.       : int  24 21 13 21 18 13 13 23 8 17 ...
##  $ Yds.       : int  28 21 19 24 17 5 5 2 9 20 ...
##  $ out.of     : int  32 32 32 32 32 32 32 32 32 32 ...
##  $ MoV        : num  -5.1 -2.3 2.1 -0.8 -2.6 2.4 1.2 -4.1 5.4 -0.4 ...
##  $ SoS        : num  -0.1 -0.8 0.6 -0.6 2.4 -0.4 -2.8 1.8 0.6 2.3 ...
##  $ SRS        : num  -5.2 -3 2.7 -1.4 -0.2 2.1 -1.6 -2.3 6.1 1.9 ...
##  $ OSRS       : num  -1.2 -3.3 5.2 -1.3 1 -3.2 -1.2 2.1 6.9 2.4 ...
##  $ DSRS       : num  -4 0.3 -2.5 -0.1 -1.3 5.2 -0.5 -4.4 -0.8 -0.5 ...</code></pre>
<p>Before we continue with this data we should clean it up. Luckily all columns are either numeric, integer, or factor in format. This will make them easier to run the regression analysis on.</p>
<p>Some categories are missing section headers that needed to be taken out to read the data easily. Without context, some columns have the same names. We will go in add to these names so they are easier to understand.</p>
<p>Also, this analysis will only consider the Detroit Lions (even though the team was originally names the Portsmouth Spartans). Therefore we will remove the columns of the team’s name and league.</p>
<pre class="r"><code>names(lions)[c(4, 5, 6, 17, 18, 19, 20, 21, 22, 23, 24)] &lt;- c(
  &quot;wins&quot;, &quot;loss&quot;, &quot;ties&quot;, &quot;off.pts.rnk&quot;, &quot;off.yds.rnk&quot;, &quot;def.pts.rnk&quot;, 
  &quot;def.yds.rnk&quot;, &quot;tak.giv.rnk&quot;, &quot;pts.df.rnk&quot;, &quot;yds.df.rnk&quot;, &quot;num.teams&quot;
)

names(lions) &lt;- names(lions) %&gt;% str_to_lower()

lions &lt;- lions[, -c(2,3)]</code></pre>
<p>Now we have a clean data frame consisting of 27 variables and 90 rows (representing 90 years of play). We are able to now carry out our analysis.</p>
<div id="simple-linear-regression" class="section level4">
<h4>Simple Linear Regression</h4>
<p>First this data will be put through a simple linear regression model (regression with one predictor variable).</p>
<p><code>lm</code> is a built-in function of R that fits linear models. Applying it to the <code>lions</code> data set let ‘wins’ the response variable (the one we are attempting to predict) and <code>mov</code> (Margin og Victory) as the predictor variable (the one we will base the prediction on).</p>
<pre class="r"><code>slr_model &lt;- lm(wins ~ mov, data = lions)

summary(slr_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = wins ~ mov, data = lions)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8672 -1.4241  0.0451  1.0530  4.6514 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.44107    0.16472   39.10   &lt;2e-16 ***
## mov          0.32411    0.02516   12.88   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.556 on 88 degrees of freedom
## Multiple R-squared:  0.6534, Adjusted R-squared:  0.6495 
## F-statistic: 165.9 on 1 and 88 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>confint(slr_model)</code></pre>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) 6.1137357 6.7684091
## mov         0.2741033 0.3741208</code></pre>
<p>The <code>summary</code> function gives an overview of the model (coefficients, residuals, levels of significance, etc.) and the <code>confint</code> function gives the confidence interval for each coefficent estimate (default is 95%).</p>
<p>The output gives a simple linear regression model with the formula to predict the wins the Lions will have:</p>
<p><span class="math inline">\(\text{wins } = 6.44107 + 0.32411 * \text{ mov }\)</span></p>
<p>This is a very simple model. While I showed that margin of victory is the most significant predictor for the number of wins a team will have in my <a href="/projects/nfl-team-wins-regression-analysis/index.html" target="_blank">2017 NFL Regression Project</a>, there are many more variables in this dataset at our disposal to improve the model.</p>
<p>We will add in the other variables now using a multiple linear regression model.</p>
</div>
<div id="multiple-linear-regression" class="section level4">
<h4>Multiple Linear Regression</h4>
<p>I first learned the techniques showcased in this post from <em>An Introduction to Statistical Learning: with Applications in R</em>.</p>
</div>
</div>
